<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Map Project</title>
    <!-- Mapbox CSS -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet'/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- 5 Day Forcast -->
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.4.1/mapbox-gl-geocoder.min.js'></script>
    <!-- Search Bar On Map-->
    <link rel='stylesheet'
          href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.4.1/mapbox-gl-geocoder.css'
          type='text/css'/>
    <!--GOOGLE FONTS-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Henny+Penny&family=IM+Fell+English&display=swap"
          rel="stylesheet">
    <style>
        .card {
            margin: 9px;
        }

        #map {
            /* the width and height may be set to any size */
            width: 100%;
            height: 400px;
            position: fixed;
            bottom: 0;
            margin: 0;
        }

        h1 {
            background-color: #0c6efd;
            color: white;
            width: 100%;
        }

        div > .card {
            height: 275px;
        }
    </style>
</head>
<body>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<!-- Mapbox JS -->
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<!-- Custom JS -->
<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
<!-- Mapbox Geocoder Utils -->
<script src="../js/mapbox-geocoder-utils.js"></script>
<!-- Key Script Source -->
<script src="../js/keys.js"></script>
<!-- NavBar  -->
<nav class="navbar navbar-light bg-light justify-content-between">
    <a class="navbar-brand">Navbar</a>
    <form class="form-inline">
        <input id="userInput" class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
        <button id='btn' class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
</nav>

<section class="ajax-section">
    <div class="container">
        <ul class="cities"></ul>

    </div>
</section>

<!-- Map Existence -->
<div id='map'></div>
<!-- Cards for 5-day weather forecast -->
<div class="d-flex w-75" id="contianer">
    <div class="col-lg-3 card" style="width: 18rem;">
        <img class="card-img-top" src="" alt="Card image cap">
        <div class="card-body">

        </div>
    </div>
    <div class="col-lg-3 card" style="width: 18rem;">
        <img class="card-img-top" src="..." alt="Card image cap">
        <div class="card-body">

        </div>
    </div>
    <div class="col-lg-3 card" style="width: 18rem;">
        <img class="card-img-top" src="..." alt="Card image cap">
        <div class="card-body">

        </div>
    </div>
    <div class="col-lg-3 card" style="width: 18rem;">
        <img class="card-img-top" src="..." alt="Card image cap">
        <div class="card-body">

        </div>
    </div>
    <div class="col-lg-3 card" style="width: 18rem;">
        <img class="card-img-top" src="..." alt="Card image cap">
        <div class="card-body">

        </div>
    </div>
</div>
<script src="../js/keys.js"></script>
<script src="../js/mapbox-geocoder-utils.js"></script>
<script>
    "use strict";

    mapboxgl.accessToken = MAPBOX_TOKEN;

    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        zoom: 10,
        center: [-98.4916, 29.4252]
    });

    $('#btn').on('click', function () {
        // let geocoder = new MapboxGeocoder({
        //     accessToken: mapboxgl.accessToken,
        //     mapboxgl: mapboxgl
        // })
        let userInput = $("#userInput").val();
        geocode(userInput, MAPBOX_TOKEN).then(function(result) {
            console.log(result);
            map.setCenter(result);
            map.setZoom(10);
        });

    });

    // let locationName = "City";
    // $("#location").html(locationName);
    // geocoder.on('result', function (event) {
    //     console.log(event);
    //
    //     locationName = event.result.place_name;
    //     $("#location").html(locationName);
    //     getWeather(event.result.center[1], event.result.center[0])
    // });

    // map.addControl(geocoder);
    // let marker = new mapboxgl.Marker({
    //     draggable: true
    // })
    //     .setLngLat([-98.4916, 29.4252])
    //     .addTo(map);
    //
    // function onDragEnd() {
    //     let lngLat = marker.getLngLat();

    //     console.log(lngLat);
    //     getWeather(lngLat.lat, lngLat.lng);
    //     reverseGeocode({lng: -98.4861, lat: 29.4260}, MAPBOX_TOKEN).then(function (results) {
    //         console.log(results);
    //         $("#location").html(results);
    //
    //     });
    // }

    // marker.on('dragend', onDragEnd);
    // map.on("click", function (e) {
    //
    //     getWeather(e.lngLat.lat, e.lngLat.lng);
    //     if (marker !== undefined) marker.remove();
    //     marker = new mapboxgl.Marker()
    //         .setLngLat([e.lngLat.lng, e.lngLat.lat])
    //         .addTo(map);
    //
    //     $("#location").html(e);
    // });

</script>
</body>
</html>